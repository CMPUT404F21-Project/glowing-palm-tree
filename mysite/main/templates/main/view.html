{% extends 'main/base.html' %}


{% block title %}
View
{% endblock %}

{% block style %}
<style type="text/css">
.btoa {
    padding-left: 0pt !important;
}
/* h1{
    text-align: center;
} */
pre {
    display: block !important;
    padding: 9.5px  !important;
    margin: 0 0 10px  !important;
    font-size: 13px  !important;
    line-height: 1.42857143  !important;
    color: #333  !important;
    word-break: break-all  !important;
    word-wrap: break-word  !important;
    background-color: #f5f5f5 !important;
    border: 1px solid #ccc !important;
    border-radius: 4px !important;
}
.foreignBadge {
    margin-right: 3pt;
}
a#content-body{
    color: black;
    text-decoration: none;
}
a#title{
    font-size: large;
    text-decoration: none;
}
</style>
{% endblock %}

{% block content %}
    

<div class="container">                                  
    <div class="row">
        <div class="col-3" >
            <div style="position: fixed;">
                <form method="post" action="/view/" class="form-group" id="filterForm">
                    {% csrf_token %}
                      <fieldset id="categoriesFilter">  
                        <legend>Categories Filter</legend>  
                        <div class="btn-group-vertical btn-group-sm" role="group" aria-label="Basic checkbox toggle button group" style="margin-left: 30pt;">
                            <input type="checkbox" class="btn-check" id="btncheck1" autocomplete="off" name="Categories" value="Food" >
                            <label class="btn btn-outline-secondary" for="btncheck1">Food</label>
                            <input type="checkbox" class="btn-check" id="btncheck2" autocomplete="off" name="Categories" value="News" > 
                            <label class="btn btn-outline-secondary" for="btncheck2">News</label>
                            <input type="checkbox" class="btn-check" id="btncheck4" autocomplete="off" name="Categories" value="Business">
                            <label class="btn btn-outline-secondary" for="btncheck4">Business</label>
                            <input type="checkbox" class="btn-check" id="btncheck6" autocomplete="off" name="Categories" value="Sports">
                            <label class="btn btn-outline-secondary" for="btncheck6">Sports</label>
                            <input type="checkbox" class="btn-check" id="btncheck8" autocomplete="off" name="Categories" value="Games"> 
                            <label class="btn btn-outline-secondary" for="btncheck8">Games</label>
                            <input type="checkbox" class="btn-check" id="btncheck9" autocomplete="off" name="Categories" value="ACG"> 
                            <label class="btn btn-outline-secondary" for="btncheck9">ACG</label>
                          </div>
                      </fieldset>
                      <br>
                      <fieldset>
                      <legend> Server Filter</legend>
                            <div class="btn-group-vertical btn-group-sm" role="group" aria-label="Basic checkbox toggle button group" style="margin-left: 30pt;">
                                {%if team12%}
                                <input type="checkbox" class="btn-check" id="btncheck11" autocomplete="off" name="Teams" value="Team12" checked>
                                <label class="btn btn-outline-secondary" for="btncheck11">Team12</label>   
                                {%else%}
                                <input type="checkbox" class="btn-check" id="btncheck11" autocomplete="off" name="Teams" value="Team12">
                                <label class="btn btn-outline-secondary" for="btncheck11">Team12</label>
                                {%endif%}
                                
                                {%if team18%}
                                <input type="checkbox" class="btn-check" id="btncheck12" autocomplete="off" name="Teams" value="Team18" checked>
                                <label class="btn btn-outline-secondary" for="btncheck12">Team18</label>   
                                {%else%}
                                <input type="checkbox" class="btn-check" id="btncheck13" autocomplete="off" name="Teams" value="Team18">
                                <label class="btn btn-outline-secondary" for="btncheck13">Team18</label>
                                {%endif%}

                                {%if team10%}
                                <input type="checkbox" class="btn-check" id="btncheck14" autocomplete="off" name="Teams" value="Team10" checked>
                                <label class="btn btn-outline-secondary" for="btncheck14">Team10</label>  
                                {%else%}
                                <input type="checkbox" class="btn-check" id="btncheck15" autocomplete="off" name="Teams" value="Team10">
                                <label class="btn btn-outline-secondary" for="btncheck15">Team10</label>
                                {%endif%}

                                
                                {%if team02%}
                                <input type="checkbox" class="btn-check" id="btncheck16" autocomplete="off" name="Teams" value="Team02" checked>
                                <label class="btn btn-outline-secondary" for="btncheck16">Team02</label>  
                                {%else%}
                                <input type="checkbox" class="btn-check" id="btncheck17" autocomplete="off" name="Teams" value="Team02">
                                <label class="btn btn-outline-secondary" for="btncheck17">Team02</label>
                                {%endif%}

                                {%if team17%}
                                <input type="checkbox" class="btn-check" id="btncheck18" autocomplete="off" name="Teams" value="Team17" checked>
                                <label class="btn btn-outline-secondary" for="btncheck18">Team17</label>  
                                {%else%}
                                <input type="checkbox" class="btn-check" id="btncheck19" autocomplete="off" name="Teams" value="Team17">
                                <label class="btn btn-outline-secondary" for="btncheck19">Team17</label>
                                {%endif%}

                                {%if team23%}
                                <input type="checkbox" class="btn-check" id="btncheck20" autocomplete="off" name="Teams" value="Team23" checked>
                                <label class="btn btn-outline-secondary" for="btncheck20">Team23</label>  
                                {%else%}
                                <input type="checkbox" class="btn-check" id="btncheck21" autocomplete="off" name="Teams" value="Team23">
                                <label class="btn btn-outline-secondary" for="btncheck21">Team23</label>
                                {%endif%}
                            </div>
                        </fieldset>
                        <br>
                      <input id="submitButton" class="btn btn-primary" type="submit" value="apply" style="margin-left: 30pt;">
                </form>
              </div>

        </div>
        
        <div class="col-7">
            
            

            <script>
                var contentBody;
                var counter = 0;
                var src = '{{content | safe}}';
                var categories = '{{categoriesNeeded | safe}}'

                
                

                src = JSON.parse(src);
                categories = JSON.parse(categories);
                
                let fieldset = document.getElementById("categoriesFilter")
                fieldset = fieldset.children[1] 
                
                for(child of fieldset.children){
                    if(categories.includes(child.value)){
                        child.checked = true;
                    }
                }


                function addImage(contentBody){
                    let img = new Image();
                    img.src = src[counter];
                    // console.log(img.src);
                    contentBody.appendChild(img);
                    contentBody.setAttribute('style', 'display:flex; justify-content: center');
                }
            </script>
            {% for pl in showList %}
        
            
            <div class="moment" style="margin-top:20pt;">
                
                <div class="card">
                    <div class="card-header">
                        Posted by  <a style="text-decoration: none;font-size: large;" href="{{pl.user.id}}">{{pl.user.displayName}}</a>
                        <br>
                        At:{{pl.published}}
                        <br>
                        <a id="title" href="{{pl.id}}">{{pl.title}}</a>
                    </div>
                    
                  <div class="card-body"><a id="content-body" href="{{pl.id}}"></a></div>
        
                {% if pl.contentType == "application/base64" or pl.contentType == "image/png;base64" or pl.contentType == "image/jpeg;base64" %}
                  <script type="text/javascript">
                      contentBody = [...document.querySelectorAll('#content-body')][counter];
                      addImage(contentBody);
                      counter += 1;
                  </script>
                {% else %}
                    <script type="text/javascript">
                        contentBody = [...document.querySelectorAll('#content-body')][counter];
                        contentBody.innerHTML = src[counter];
                        counter += 1;
                    </script>
                {% endif %}
                    <div class="card-footer" >
                        {% for c in pl.categories %}
                            <span class="badge bg-secondary">{{c}} </span>
                        {% endfor %}
                    </div> 
                </div>
            </div> 
             
            {% endfor %}
        
        {%if team10 or team12 or team18 or team02 or team17%}
        <h4 style="text-align: center; margin-top: 30pt;"> Posts from other servers</h4>
        <hr class="" style="margin-left: auto; margin-right: auto;">
        {%endif%}
        
        

        {% if team10 %}
        <script>
            function sleep(seconds) {
                var e = new Date().getTime() + (seconds);
                while (new Date().getTime() <= e) {}
            }
            // 2dc59103754a77ac6a2de5a43fd9f994dc52e32a  T10 Auth token
            let url10 = "https://social-distribution-t10.herokuapp.com/api/";
            // let url18 = "https://cmput404-socialdistributio-t18.herokuapp.com/"
            // let tokens = []
            // let url10 = "https://glowing-palm-tree1.herokuapp.com/service/authors/"
            let h1 = new Headers();
            h1.append("Authorization", "Basic dDEyOkNNUFVUNDA0");
            let foreignAuthor = [];
            let req = new Request(url10+"authors/", {
                method: 'GET',
                mode: 'cors',
                headers: h1
            });
            fetch(req)
            .then(response => response.json())
            .then(data => {
    
    
                
                let jsonData = data;
                jsonData = jsonData["data"];
                if (!jsonData){
                    return;
                }
                for (let author of jsonData){
                    sleep(1100);
                    let url = author['id'] + "/posts/";
                    let h2 = new Headers();
                    h2.append("Authorization", "Basic dDEyOkNNUFVUNDA0");
                    let postReq = new Request(url,{
                        method: 'GET',
                        mode: 'cors',
                        headers: h2
                    });
                    fetch(postReq)
                    .then(response => response.json())
                    .then(data =>{
                        
                        
                        let postData = data;
                        postData = postData["data"];
    
                        if (!postData){
                            return;
                        }
    
                        for (let post of postData){
                            let oldDiv = document.querySelector(".moment");
                            let newDiv = document.createElement("div");
                            newDiv.innerHTML = oldDiv.innerHTML;
                            newDiv.setAttribute("style","margin-top:40pt;");
                            newDiv.setAttribute("class", "moment");
                            oldDiv.parentElement.appendChild(newDiv);
                            let empty = document.createElement("div")
                            thisCategories = post["categories"]
                          
                            newDiv.children[0].children[3].innerHTML = null    
                            
                            if(thisCategories){
                                for(cat of thisCategories){
                                
                                    if(cat){
                                        let badge = document.createElement("span");
                                        badge.setAttribute("class", "badge bg-secondary foreignBadge");
                                        badge.innerHTML = cat;
                                        newDiv.children[0].children[3].appendChild(badge)
                                    }else{
                                        newDiv.children[0].children[3].innerHTML = null
                                    }
                                }
                            }
                                
                            let heading = newDiv.children[0].children[0];
                            let body = newDiv.children[0].children[1];
                            let tags = newDiv.children[0].children[3];
                                //console.log(tags)
                            
                            // let buttons = newDiv.children[1];
            
                            // let shareButton = buttons.children[0];
                            // let commentButton = buttons.children[1];
                            // let likeButton = buttons.children[2];
            
                            // likeButton.herf = "#";
                            // likeUrlT10 = post["author"]["id"] + "/inbox/";
                            // objectUrlT10 = post["source"];
                            // likeButton.setAttribute("onclick", 'sendLike(likeUrlT10, objectUrlT10)');
                            // // likeButton.addEventListener('click', sendLike(url10 + "author/" + post["author"]["id"] + "/inbox/"));
                            
            
                            newForm1 = document.createElement("form")
                            newForm1.setAttribute("action","/remoteUser/detail/")
                            newForm1.setAttribute("method","post")
                            profileButton = document.createElement("button")
            
                            authorName = post["author"]['displayName']
                            profileButton.innerText = "Posted by " + authorName
                            profileButton.setAttribute("class", "btn btn-link btoa")
                            profileButton.setAttribute("role", "link")
                            profileButton.setAttribute("style", "text-decoration:none;font-size:large")
            
                            profileButton.setAttribute("type","submit")
                            hiddenValue1 = document.createElement("input")
                            hiddenValue1.setAttribute("type", "hidden")
                            hiddenValue1.setAttribute("name", "data")
                            hiddenValue1.setAttribute("value", JSON.stringify(post['author']))
            
                            newForm1.appendChild(profileButton)
                            newForm1.appendChild(hiddenValue1)
                            newForm1.innerHTML += '{% csrf_token %}'
                            
            
                            heading.removeChild(heading.children[1])
                            heading.appendChild(newForm1)
            
                            
            
                            newForm = document.createElement("form")
                            newForm.setAttribute("action","/remotePost/detail/")
                            newForm.setAttribute("method","post")
                            titleButton = document.createElement("button")
                            titleButton.setAttribute("class", "btn btn-link btoa")
                            titleButton.setAttribute("role", "link")
                            titleButton.setAttribute("style", "text-decoration:none;font-size:large")
            
            
                            titleButton.innerText = post["title"]
                            titleButton.setAttribute("type","submit")
                            hiddenValue = document.createElement("input")
                            hiddenValue.setAttribute("type", "hidden")
                            hiddenValue.setAttribute("name", "data")
                            hiddenValue.setAttribute("value", JSON.stringify(post))

            
                            newForm.appendChild(titleButton)
                            newForm.appendChild(hiddenValue)
                            newForm.innerHTML += '{% csrf_token %}'
            
                            newDiv1 = document.createElement("div")
                            newDiv1.textContent = "At: " + post["published"];
            
            
                            heading.innerHTML = ''
            
                            heading.appendChild(newForm1)
                            heading.appendChild(newDiv1)
                            heading.appendChild(newForm)
            
                            let text = post["contentType"];
            
                            let temp = body.children[0];
                            if (temp){
                                temp.parentElement.removeChild(temp);
                            }
                            if (['application/base64', 'image/png;base64', 'image/jpeg;base64'].includes(text)){
                                let img = new Image();
                                img.src = post["content"];
                                body.appendChild(img);
                                body.setAttribute("style", "justify-content:center;display:flex;");
                            }else if (['text/markdown'].includes(text)){
                                let converter = new showdown.Converter();
                                html = converter.makeHtml(post["content"]);
                                body.innerHTML = html;
                                body.setAttribute("style", "");
                            }else{
                                body.textContent = post["content"];
                                body.setAttribute("style", "");
                            }
                        }
                    })
                }
            })
            </script>
        {% endif %}
        


        {% if team18 %}
        <script>
            // 2dc59103754a77ac6a2de5a43fd9f994dc52e32a  T10 Auth token
            t18Token = btoa("Team12:CMPUT404");
            console.log(t18Token);
            // let url10 = "https://social-distribution-t10.herokuapp.com/api/";
            let url18 = "https://cmput404-socialdistributio-t18.herokuapp.com/"
            // let tokens = []
            // let url10 = "https://glowing-palm-tree1.herokuapp.com/service/authors/"
            let h3 = new Headers();
            h3.append("Authorization", "Token " + t18Token);
            let foreignAuthor1 = [];
            let req1 = new Request(url18+"authors", {
                method: 'GET',
                mode: 'cors',
                headers: h3
            });
            fetch(req1)
            .then(response => response.json() )
            .then(data => {


                

                let jsonData = data;
        
                jsonData = jsonData["data"];
                if (!jsonData){
                    return;
                }
                for (let author of jsonData){
                    let api = author["host"] ;
                    // console.log(api)
                    let rest = author["id"].replace(author["host"], "");
                    // console.log(rest)
                    let url = api +'/author/' + rest + "/posts/";
                    let h2 = new Headers();
                    h2.append("Authorization", "Token " + t18Token);
                    let postReq = new Request(url,{
                        method: 'GET',
                        mode: 'cors',
                        headers: h2
                    });
                    fetch(postReq)
                    .then(response => response.json())
                    .then(data =>{




                        let postData = data;
                        postData = postData["data"];
                        if (!postData){
                            return;
                        }
                        for (let post of postData){
                            let oldDiv = document.querySelector(".moment");
                            let newDiv = document.createElement("div");
                            newDiv.innerHTML = oldDiv.innerHTML;
                            newDiv.setAttribute("style","margin-top:40pt;");
                            newDiv.setAttribute("class", "moment");
                            oldDiv.parentElement.appendChild(newDiv);
            
                            let heading = newDiv.children[0].children[0];
                            let body = newDiv.children[0].children[1];
                            let tags = newDiv.children[0].children[3];
                            //console.log(tags)
                            let empty = document.createElement("div")

                            thisCategories = post["categories"]

                            


                            newDiv.children[0].children[3].innerHTML = null
                            if(thisCategories){
                                for(cat of thisCategories){
                                    console.log(cat)
                                    if(cat){
                                        let badge = document.createElement("span");
                                        badge.setAttribute("class", "badge bg-secondary foreignBadge");
                                        badge.innerHTML = cat;
                                        newDiv.children[0].children[3].appendChild(badge)
                                    }else{
                                        newDiv.children[0].children[3].innerHTML = empty
                                    }
                                }
                            }
                       
        
                            newForm1 = document.createElement("form")
                            newForm1.setAttribute("action","/remoteUser/detail/")
                            newForm1.setAttribute("method","post")
                            profileButton = document.createElement("button")
        
                            authorName = post["author"]['displayName']
                            profileButton.innerText = "Posted by " + authorName
                            profileButton.setAttribute("class", "btn btn-link btoa")
                            profileButton.setAttribute("role", "link")
                            profileButton.setAttribute("style", "text-decoration:none;font-size:large")
        
                            profileButton.setAttribute("type","submit")
                            hiddenValue1 = document.createElement("input")
                            hiddenValue1.setAttribute("type", "hidden")
                            hiddenValue1.setAttribute("name", "data")
                            hiddenValue1.setAttribute("value", JSON.stringify(post['author']))
        
                            newForm1.appendChild(profileButton)
                            newForm1.appendChild(hiddenValue1)
                            newForm1.innerHTML += '{% csrf_token %}'
                            
        
                            heading.removeChild(heading.children[1])
                            heading.appendChild(newForm1)
        
                            
        
                            newForm = document.createElement("form")
                            newForm.setAttribute("action","/remotePost/detail/")
                            newForm.setAttribute("method","post")
                            titleButton = document.createElement("button")
                            titleButton.setAttribute("class", "btn btn-link btoa")
                            titleButton.setAttribute("role", "link")
                            titleButton.setAttribute("style", "text-decoration:none;font-size:large")
        
                            titleButton.innerText = post["title"]
                            titleButton.setAttribute("type","submit")
                            hiddenValue = document.createElement("input")
                            hiddenValue.setAttribute("type", "hidden")
                            hiddenValue.setAttribute("name", "data")
                            hiddenValue.setAttribute("value", JSON.stringify(post))
        
                            newForm.appendChild(titleButton)
                            newForm.appendChild(hiddenValue)
                            newForm.innerHTML += '{% csrf_token %}'
        
                            newDiv1 = document.createElement("div")
                            newDiv1.textContent = "At: " + post["published"];
        
        
                            heading.innerHTML = ''
        
                            heading.appendChild(newForm1)
                            heading.appendChild(newDiv1)
                            heading.appendChild(newForm)


                            let text = post["contentType"];
            
                            let temp = body.children[0];
                                if (temp){
                                temp.parentElement.removeChild(temp);
                                }
                            if (['application/base64', 'image/png;base64', 'image/jpeg;base64'].includes(text)){
                                
                                let img = new Image();
                                img.src = post["content"];
                                body.appendChild(img);
                                body.setAttribute("style", "justify-content:center;display:flex;");
                            }else if (['text/markdown'].includes(text)){
                                let converter = new showdown.Converter();
                                html = converter.makeHtml(post["content"]);
                                body.innerHTML = html;
                                body.setAttribute("style", "");
                            }else{
                                body.textContent = post["content"];
                                body.setAttribute("style", "");
                            }
                        }
                    })
                }
            })
            </script>

        {% endif %}
    

        

        {% if team12 %}
        <script>
            // 2dc59103754a77ac6a2de5a43fd9f994dc52e32a  T10 Auth token
            let url12 = "https://glowing-palm-tree1.herokuapp.com/service/";
            // let url18 = "https://cmput404-socialdistributio-t18.herokuapp.com/"
            // let tokens = []
            // let url10 = "https://glowing-palm-tree1.herokuapp.com/service/authors/"
            h1 = new Headers();
            h1.append("Authorization", "Token 29ada9ea8c040ecf9874b549d9949a3e3748b62e");
            foreignAuthor = [];
            req = new Request(url12+"authors/", {
                method: 'GET',
                mode: 'cors',
                headers: h1
            });


            fetch(req)
            .then(response => response.json())
            .then(data => {

                

                

                let jsonData = data;
                jsonData = jsonData["data"];
                if (!jsonData){
                    return;
                }


                

                for (let author of jsonData){
                    let url = author['id'] + "/posts/";
                    let h2 = new Headers();
                    h2.append("Authorization", "Token 2dc59103754a77ac6a2de5a43fd9f994dc52e32a");
                    let postReq = new Request(url,{
                        method: 'GET',
                        mode: 'cors',
                        headers: h2
                    });
                    fetch(postReq)
                    .then(response => response.json())
                    .then(data =>{
                        let postData = data;
                        postData = postData["data"];
                        if (!postData){
                            return;
                        }
                        for (let post of postData){
                            let oldDiv = document.querySelector(".moment");
                            let newDiv = document.createElement("div");
                            newDiv.innerHTML = oldDiv.innerHTML;
                            newDiv.setAttribute("style","margin-top:40pt;");
                            newDiv.setAttribute("class", "moment");
                            oldDiv.parentElement.appendChild(newDiv);
            
                            let heading = newDiv.children[0].children[0];
                            let body = newDiv.children[0].children[1];
                            let tags = newDiv.children[0].children[3];
                            let empty = document.createElement("div")
                            //console.log(tags)
                            thisCategories = post["categories"]
                            let doIt = false
                            
                            newDiv.children[0].children[3].innerHTML = null
                            if(thisCategories){
                                for(cat of thisCategories){
                                
                                    if(cat){
                                        let badge = document.createElement("span");
                                        badge.setAttribute("class", "badge bg-secondary foreignBadge");
                                        badge.innerHTML = cat;
                                        newDiv.children[0].children[3].appendChild(badge)
                                    }else{
                                        newDiv.children[0].children[3].innerHTML = null
                                    }
                                }
                            }
                            
                            // let buttons = newDiv.children[1];
            
                            // let shareButton = buttons.children[0];
                            // let commentButton = buttons.children[1];
                            // let likeButton = buttons.children[2];
            
                            // likeButton.herf = "#";
                            // likeUrlT10 = post["author"]["id"] + "/inbox/";
                            // objectUrlT10 = post["source"];
                            // likeButton.setAttribute("onclick", 'sendLike(likeUrlT10, objectUrlT10)');
                            // // likeButton.addEventListener('click', sendLike(url10 + "author/" + post["author"]["id"] + "/inbox/"));
                            
            
                            newForm1 = document.createElement("form")
                            newForm1.setAttribute("action","/remoteUser/detail/")
                            newForm1.setAttribute("method","post")
                            profileButton = document.createElement("button")
            
                            authorName = post["author"]['displayName']
                            profileButton.innerText = "Posted by " + authorName
                            profileButton.setAttribute("class", "btn btn-link btoa")
                            profileButton.setAttribute("role", "link")
                            profileButton.setAttribute("style", "text-decoration:none;font-size:large")
                            
                            profileButton.setAttribute("type","submit")
                            hiddenValue1 = document.createElement("input")
                            hiddenValue1.setAttribute("type", "hidden")
                            hiddenValue1.setAttribute("name", "data")
                            hiddenValue1.setAttribute("value", JSON.stringify(post['author']))
            
                            newForm1.appendChild(profileButton)
                            newForm1.appendChild(hiddenValue1)
                            newForm1.innerHTML += '{% csrf_token %}'
                            
            
                            heading.removeChild(heading.children[1])
                            heading.appendChild(newForm1)
            
                            
            
                            newForm = document.createElement("form")
                            newForm.setAttribute("action","/remotePost/detail/")
                            newForm.setAttribute("method","post")
                            titleButton = document.createElement("button")
                            titleButton.setAttribute("class", "btn btn-link btoa")
                            titleButton.setAttribute("role", "link")
                            titleButton.setAttribute("style", "text-decoration:none;font-size:large")
                            
            
            
                            titleButton.innerText = post["title"]
                            titleButton.setAttribute("type","submit")
                            hiddenValue = document.createElement("input")
                            hiddenValue.setAttribute("type", "hidden")
                            hiddenValue.setAttribute("name", "data")
                            hiddenValue.setAttribute("value", JSON.stringify(post))
            
                            newForm.appendChild(titleButton)
                            newForm.appendChild(hiddenValue)
                            newForm.innerHTML += '{% csrf_token %}'
            
                            newDiv1 = document.createElement("div")
                            newDiv1.textContent = "At: " + post["published"];
            
            
                            heading.innerHTML = ''
            
                            heading.appendChild(newForm1)
                            heading.appendChild(newDiv1)
                            heading.appendChild(newForm)
            
                            let text = post["contentType"];
            
                            let temp = body.children[0];
                                if (temp){
                                temp.parentElement.removeChild(temp);
                                }
                            if (['application/base64', 'image/png;base64', 'image/jpeg;base64'].includes(text)){
                                
                                let img = new Image();
                                img.src = post["content"];
                                body.appendChild(img);
                                body.setAttribute("style", "justify-content:center;display:flex;");
                            }else if (['text/markdown'].includes(text)){
                                let converter = new showdown.Converter();
                                html = converter.makeHtml(post["content"]);
                                body.innerHTML = html;
                                body.setAttribute("style", "");
                            }else {
                                body.textContent = post["content"];
                                body.setAttribute("style", "");
                            }
                        }
                    })
                }
            })
            </script>
        {% endif %}


        {% if team02 %}
        <script>
            // 2dc59103754a77ac6a2de5a43fd9f994dc52e32a  T10 Auth token
            let url02 = "https://ourbackend.herokuapp.com/";
            // let url18 = "https://cmput404-socialdistributio-t18.herokuapp.com/"
            // let tokens = []
            // let url10 = "https://glowing-palm-tree1.herokuapp.com/service/authors/"
            h1 = new Headers();
            h1.append("Authorization", "Basic VDEyOkNNUFVUNDA0");
            foreignAuthor = [];
            req = new Request(url02+"authors/", {
                method: 'GET',
                mode: 'cors',
                headers: h1
            });


            fetch(req)
            .then(response => response.json())
            .then(data => {

                

                

                let jsonData = data;
                jsonData = jsonData["authors"];
                if (!jsonData){
                    return;
                }


                

                for (let author of jsonData){
                    //let url = author['url'] + "/posts/";
                    let url = "https://ourbackend.herokuapp.com/author/" + author['author_id'] + '/posts/'
                    let h2 = new Headers();
                    h2.append("Authorization", "Basic VDEyOkNNUFVUNDA0");
                    let postReq = new Request(url,{
                        method: 'GET',
                        mode: 'cors',
                        headers: h2
                    });
                    fetch(postReq)
                    .then(response => response.json())
                    .then(data =>{
                        let postData = data;
                        postData = postData["posts"];
                        if (!postData){
                            return;
                        }
                        for (let post of postData){
                            let oldDiv = document.querySelector(".moment");
                            let newDiv = document.createElement("div");
                            newDiv.innerHTML = oldDiv.innerHTML;
                            newDiv.setAttribute("style","margin-top:40pt;");
                            newDiv.setAttribute("class", "moment");
                            oldDiv.parentElement.appendChild(newDiv);
            
                            let heading = newDiv.children[0].children[0];
                            let body = newDiv.children[0].children[1];
                            let tags = newDiv.children[0].children[3];
                            let empty = document.createElement("div")
                            //console.log(tags)
                            thisCategories = post["categories"]
                            let doIt = false
                            
                            newDiv.children[0].children[3].innerHTML = null
                            if(thisCategories){
                                for(cat of thisCategories){
                                
                                    if(cat){
                                        let badge = document.createElement("span");
                                        badge.setAttribute("class", "badge bg-secondary foreignBadge");
                                        badge.innerHTML = cat;
                                        newDiv.children[0].children[3].appendChild(badge)
                                    }else{
                                        newDiv.children[0].children[3].innerHTML = null
                                    }
                                }
                            }
                            
                            // let buttons = newDiv.children[1];
            
                            // let shareButton = buttons.children[0];
                            // let commentButton = buttons.children[1];
                            // let likeButton = buttons.children[2];
            
                            // likeButton.herf = "#";
                            // likeUrlT10 = post["author"]["id"] + "/inbox/";
                            // objectUrlT10 = post["source"];
                            // likeButton.setAttribute("onclick", 'sendLike(likeUrlT10, objectUrlT10)');
                            // // likeButton.addEventListener('click', sendLike(url10 + "author/" + post["author"]["id"] + "/inbox/"));
                            
            
                            newForm1 = document.createElement("form")
                            newForm1.setAttribute("action","/remoteUser/detail/")
                            newForm1.setAttribute("method","post")
                            profileButton = document.createElement("button")
            
                            authorName = post["author"]['displayName']
                            profileButton.innerText = "Posted by " + authorName
                            profileButton.setAttribute("class", "btn btn-link btoa")
                            profileButton.setAttribute("role", "link")
                            profileButton.setAttribute("style", "text-decoration:none;font-size:large")
                            
            
                            profileButton.setAttribute("type","submit")
                            hiddenValue1 = document.createElement("input")
                            hiddenValue1.setAttribute("type", "hidden")
                            hiddenValue1.setAttribute("name", "data")
                            hiddenValue1.setAttribute("value", JSON.stringify(post['author']))
            
                            newForm1.appendChild(profileButton)
                            newForm1.appendChild(hiddenValue1)
                            newForm1.innerHTML += '{% csrf_token %}'
                            
            
                            heading.removeChild(heading.children[1])
                            heading.appendChild(newForm1)
            
                            
            
                            newForm = document.createElement("form")
                            newForm.setAttribute("action","/remotePost/detail/")
                            newForm.setAttribute("method","post")
                            titleButton = document.createElement("button")
                            titleButton.setAttribute("class", "btn btn-link btoa")
                            titleButton.setAttribute("role", "link")
                            titleButton.setAttribute("style", "text-decoration:none;font-size:large")
            
            
                            titleButton.innerText = post["title"]
                            titleButton.setAttribute("type","submit")
                            hiddenValue = document.createElement("input")
                            hiddenValue.setAttribute("type", "hidden")
                            hiddenValue.setAttribute("name", "data")
                            hiddenValue.setAttribute("value", JSON.stringify(post))
            
                            newForm.appendChild(titleButton)
                            newForm.appendChild(hiddenValue)
                            newForm.innerHTML += '{% csrf_token %}'
            
                            newDiv1 = document.createElement("div")
                            newDiv1.textContent = "At: " + post["published"];
            
            
                            heading.innerHTML = ''
            
                            heading.appendChild(newForm1)
                            heading.appendChild(newDiv1)
                            heading.appendChild(newForm)
            
                            let text = post["contentType"];
            
                            let temp = body.children[0];
                                if (temp){
                                temp.parentElement.removeChild(temp);
                                }
                            if (['application/base64', 'image/png;base64', 'image/jpeg;base64'].includes(text)){
                                
                                let img = new Image();
                                img.src = post["content"];
                                body.appendChild(img);
                                body.setAttribute("style", "justify-content:center;display:flex;");
                            }else if (['text/markdown'].includes(text)){
                                let converter = new showdown.Converter();
                                html = converter.makeHtml(post["content"]);
                                body.innerHTML = html;
                                body.setAttribute("style", "");
                            }else{
                                body.textContent = post["content"];
                                body.setAttribute("style", "");
                            }
                        }
                    })
                }
            })
            </script>
        {% endif %}


        {% if team17 %}
        <script>
            // 2dc59103754a77ac6a2de5a43fd9f994dc52e32a  T10 Auth token
            let url17 = "https://cmput404f21t17.herokuapp.com/service/";
            // let url18 = "https://cmput404-socialdistributio-t18.herokuapp.com/"
            // let tokens = []
            // let url10 = "https://glowing-palm-tree1.herokuapp.com/service/authors/"
            h1 = new Headers();
            h1.append("Authorization", "Basic NmNmMGE1MDYtYWQ1Mi00YjNkLWEzMjMtMzRiOTc3NmNiYmE1OjEyMzQ1Ng==");
            foreignAuthor = [];
            req = new Request(url17 +"authors/", {
                method: 'GET',
                headers: h1
            });


            fetch(req)
            .then(response => response.json())
            .then(data => {
                let jsonData = data;
                jsonData = jsonData["items"];
                if (!jsonData){
                    return;
                }
                for (let author of jsonData){
                    if (author['host'] !== "https://cmput404f21t17.herokuapp.com/"){
                        continue;
                    }
                    
                    let url = author['url'] + "/posts/";
                    // let url = "https://ourbackend.herokuapp.com/author/" + author['author_id'] + '/posts/'
                    let h2 = new Headers();
                    h2.append("Authorization", "Basic NmNmMGE1MDYtYWQ1Mi00YjNkLWEzMjMtMzRiOTc3NmNiYmE1OjEyMzQ1Ng==");
                    let postReq = new Request(url,{
                        method: 'GET',
                        headers: h2
                    });
                    fetch(postReq)
                    .then(response => response.json())
                    .then(data =>{
                        let postData = data;
                        postData = postData["items"];
                        if (!postData){
                            return;
                        }
                        for (let post of postData){
                            let oldDiv = document.querySelector(".moment");
                            let newDiv = document.createElement("div");
                            newDiv.innerHTML = oldDiv.innerHTML;
                            newDiv.setAttribute("style","margin-top:40pt;");
                            newDiv.setAttribute("class", "moment");
                            oldDiv.parentElement.appendChild(newDiv);
            
                            let heading = newDiv.children[0].children[0];
                            let body = newDiv.children[0].children[1];
                            let tags = newDiv.children[0].children[3];
                            let empty = document.createElement("div")
                            //console.log(tags)
                            thisCategories = post["categories"]
                            let doIt = false
                            
                            newDiv.children[0].children[3].innerHTML = null
                            if(thisCategories){
                                for(cat of thisCategories){
                                
                                    if(cat){
                                        let badge = document.createElement("span");
                                        badge.setAttribute("class", "badge bg-secondary foreignBadge");
                                        badge.innerHTML = cat;
                                        newDiv.children[0].children[3].appendChild(badge)
                                    }else{
                                        newDiv.children[0].children[3].innerHTML = null
                                    }
                                }
                            }
                            
                            // let buttons = newDiv.children[1];
            
                            // let shareButton = buttons.children[0];
                            // let commentButton = buttons.children[1];
                            // let likeButton = buttons.children[2];
            
                            // likeButton.herf = "#";
                            // likeUrlT10 = post["author"]["id"] + "/inbox/";
                            // objectUrlT10 = post["source"];
                            // likeButton.setAttribute("onclick", 'sendLike(likeUrlT10, objectUrlT10)');
                            // // likeButton.addEventListener('click', sendLike(url10 + "author/" + post["author"]["id"] + "/inbox/"));
                            
            
                            newForm1 = document.createElement("form")
                            newForm1.setAttribute("action","/remoteUser/detail/")
                            newForm1.setAttribute("method","post")
                            profileButton = document.createElement("button")
            
                            authorName = post["author"]['displayName']
                            profileButton.innerText = "Posted by " + authorName
                            profileButton.setAttribute("class", "btn btn-link btoa")
                            profileButton.setAttribute("role", "link")
                            profileButton.setAttribute("style", "text-decoration:none;font-size:large")
            
                            profileButton.setAttribute("type","submit")
                            hiddenValue1 = document.createElement("input")
                            hiddenValue1.setAttribute("type", "hidden")
                            hiddenValue1.setAttribute("name", "data")
                            hiddenValue1.setAttribute("value", JSON.stringify(post['author']))
            
                            newForm1.appendChild(profileButton)
                            newForm1.appendChild(hiddenValue1)
                            newForm1.innerHTML += '{% csrf_token %}'
                            
            
                            heading.removeChild(heading.children[1])
                            heading.appendChild(newForm1)
            
                            
            
                            newForm = document.createElement("form")
                            newForm.setAttribute("action","/remotePost/detail/")
                            newForm.setAttribute("method","post")
                            titleButton = document.createElement("button")
                            titleButton.setAttribute("class", "btn btn-link btoa")
                            titleButton.setAttribute("role", "link")
                            titleButton.setAttribute("style", "text-decoration:none;font-size:large")
            
            
                            titleButton.innerText = post["title"]
                            titleButton.setAttribute("type","submit")
                            hiddenValue = document.createElement("input")
                            hiddenValue.setAttribute("type", "hidden")
                            hiddenValue.setAttribute("name", "data")
                            hiddenValue.setAttribute("value", JSON.stringify(post))
                            console.log(post);
            
                            newForm.appendChild(titleButton)
                            newForm.appendChild(hiddenValue)
                            newForm.innerHTML += '{% csrf_token %}'
            
                            newDiv1 = document.createElement("div")
                            newDiv1.textContent = "At: " + post["published"];
            
            
                            heading.innerHTML = ''
            
                            heading.appendChild(newForm1)
                            heading.appendChild(newDiv1)
                            heading.appendChild(newForm)
            
                            let text = post["contentType"];
            
                            let temp = body.children[0];
                                if (temp){
                                temp.parentElement.removeChild(temp);
                                }
                            if (['application/base64', 'image/png;base64', 'image/jpeg;base64'].includes(text)){
                                
                                let img = new Image();
                                img.src = post["content"];
                                body.appendChild(img);
                                body.setAttribute("style", "justify-content:center;display:flex;");
                            }else if (['text/markdown'].includes(text)){
                                let converter = new showdown.Converter();
                                html = converter.makeHtml(post["content"]);
                                body.innerHTML = html;
                                body.setAttribute("style", "");
                            }else{
                                body.textContent = post["content"];
                                body.setAttribute("style", "");
                            }
                        }
                    })
                }
            })
            </script>
        {% endif %}


        {% if team23 %}
        <script>
            // 2dc59103754a77ac6a2de5a43fd9f994dc52e32a  T10 Auth token
            let url23 = "https://project-api-404.herokuapp.com/api/";
            // let url18 = "https://cmput404-socialdistributio-t18.herokuapp.com/"
            // let tokens = []
            // let url10 = "https://glowing-palm-tree1.herokuapp.com/service/authors/"
            h1 = new Headers();
            h1.append("Authorization", "Basic dGVhbTEyOnRlYW0xMg==");
            foreignAuthor = [];
            req = new Request(url23 +"authors/", {
                method: 'GET',
                headers: h1
            });


            fetch(req)
            .then(response => response.json())
            .then(data => {
                let jsonData = data;;
                if (!jsonData){
                    return;
                }
                for (let author of jsonData){                    
                    let url = author['url'] + "/posts/";
                    // let url = "https://ourbackend.herokuapp.com/author/" + author['author_id'] + '/posts/'
                    h2 = new Headers();
                    h2.append("Authorization", "Basic dGVhbTEyOnRlYW0xMg==");
                    let postReq = new Request(url,{
                        method: 'GET',
                        headers: h2
                    });
                    fetch(postReq)
                    .then(response => response.json())
                    .then(data =>{
                        let postData = data;
                        postData = postData["items"];
                        if (!postData){
                            return;
                        }
                        for (let post of postData){
                            let oldDiv = document.querySelector(".moment");
                            let newDiv = document.createElement("div");
                            newDiv.innerHTML = oldDiv.innerHTML;
                            newDiv.setAttribute("style","margin-top:40pt;");
                            newDiv.setAttribute("class", "moment");
                            oldDiv.parentElement.appendChild(newDiv);
            
                            let heading = newDiv.children[0].children[0];
                            let body = newDiv.children[0].children[1];
                            let tags = newDiv.children[0].children[3];
                            let empty = document.createElement("div")
                            //console.log(tags)
                            thisCategories = post["categories"]
                            let doIt = false
                            
                            newDiv.children[0].children[3].innerHTML = null
                            if(thisCategories){
                                for(cat of thisCategories){
                                
                                    if(cat){
                                        let badge = document.createElement("span");
                                        badge.setAttribute("class", "badge bg-secondary foreignBadge");
                                        badge.innerHTML = cat;
                                        newDiv.children[0].children[3].appendChild(badge)
                                    }else{
                                        newDiv.children[0].children[3].innerHTML = null
                                    }
                                }
                            }
                            
                            // let buttons = newDiv.children[1];
            
                            // let shareButton = buttons.children[0];
                            // let commentButton = buttons.children[1];
                            // let likeButton = buttons.children[2];
            
                            // likeButton.herf = "#";
                            // likeUrlT10 = post["author"]["id"] + "/inbox/";
                            // objectUrlT10 = post["source"];
                            // likeButton.setAttribute("onclick", 'sendLike(likeUrlT10, objectUrlT10)');
                            // // likeButton.addEventListener('click', sendLike(url10 + "author/" + post["author"]["id"] + "/inbox/"));
                            
            
                            newForm1 = document.createElement("form")
                            newForm1.setAttribute("action","/remoteUser/detail/")
                            newForm1.setAttribute("method","post")
                            profileButton = document.createElement("button")
            
                            authorName = post["author"]['displayName']
                            profileButton.innerText = "Posted by " + authorName
                            profileButton.setAttribute("class", "btn btn-link btoa")
                            profileButton.setAttribute("role", "link")
                            profileButton.setAttribute("style", "text-decoration:none;font-size:large")
            
                            profileButton.setAttribute("type","submit")
                            hiddenValue1 = document.createElement("input")
                            hiddenValue1.setAttribute("type", "hidden")
                            hiddenValue1.setAttribute("name", "data")
                            hiddenValue1.setAttribute("value", JSON.stringify(post['author']))
            
                            newForm1.appendChild(profileButton)
                            newForm1.appendChild(hiddenValue1)
                            newForm1.innerHTML += '{% csrf_token %}'
                            
            
                            heading.removeChild(heading.children[1])
                            heading.appendChild(newForm1)
            
                            
            
                            newForm = document.createElement("form")
                            newForm.setAttribute("action","/remotePost/detail/")
                            newForm.setAttribute("method","post")
                            titleButton = document.createElement("button")
                            titleButton.setAttribute("class", "btn btn-link btoa")
                            titleButton.setAttribute("role", "link")
                            titleButton.setAttribute("style", "text-decoration:none;font-size:large")
            
            
                            titleButton.innerText = post["title"]
                            titleButton.setAttribute("type","submit")
                            hiddenValue = document.createElement("input")
                            hiddenValue.setAttribute("type", "hidden")
                            hiddenValue.setAttribute("name", "data")
                            hiddenValue.setAttribute("value", JSON.stringify(post))
                            console.log(post);
            
                            newForm.appendChild(titleButton)
                            newForm.appendChild(hiddenValue)
                            newForm.innerHTML += '{% csrf_token %}'
            
                            newDiv1 = document.createElement("div")
                            newDiv1.textContent = "At: " + post["published"];
            
            
                            heading.innerHTML = ''
            
                            heading.appendChild(newForm1)
                            heading.appendChild(newDiv1)
                            heading.appendChild(newForm)
            
                            let text = post["contentType"];
            
                            let temp = body.children[0];
                                if (temp){
                                temp.parentElement.removeChild(temp);
                                }
                            if (['application/base64', 'image/png;base64', 'image/jpeg;base64'].includes(text)){
                                
                                let img = new Image();
                                img.src = post["content"];
                                body.appendChild(img);
                                body.setAttribute("style", "justify-content:center;display:flex;");
                            }else if (['text/markdown'].includes(text)){
                                let converter = new showdown.Converter();
                                html = converter.makeHtml(post["content"]);
                                body.innerHTML = html;
                                body.setAttribute("style", "");
                            }else{
                                body.textContent = post["content"];
                                body.setAttribute("style", "");
                            }
                        }
                    })
                }
            })
            </script>
        {% endif %}
        
        
            
        </div>
        <div class="col-2" >


            
         </div>
    </div>
    
</div>
  
{% endblock %}
{
    "type":"comment",
    "author":{
        "type":"author",
        "id":"0fbc1b88-2d7c-44a4-83b9-ef5b1198f692",
        "host":"https://cmput404f21t17.herokuapp.com/",
        "displayName":"",
        "url":"https://cmput404f21t17.herokuapp.com/service/author/0fbc1b88-2d7c-44a4-83b9-ef5b1198f692",
        "github":"https://github.com/xingjiehe",
        "profileImage":""
    },
    "comment":"COMMENT",
    "text":"COMMENT",
    "contentType":"text/plain",
    "published":"Sun Dec 05 2021 21:17:15 GMT-0700 (Mountain Standard Time)",
    "id":"http://localhost:8000/service/post/025bdeef-e3c0-4195-a1dc-0ced6571992e/comments/140bd85d-93de-4301-8fac-0343bd36f88f",
    "url":"https://cmput404f21t17.herokuapp.com/author/0fbc1b88-2d7c-44a4-83b9-ef5b1198f692"
}

{
    "type":"comment",
    "author":{
        "type":"author",
        "id":"0fbc1b88-2d7c-44a4-83b9-ef5b1198f692",
        "host":"https://cmput404f21t17.herokuapp.com/",
        "displayName":"",
        "url":"https://cmput404f21t17.herokuapp.com/service/author/0fbc1b88-2d7c-44a4-83b9-ef5b1198f692","github":"https://github.com/xingjiehe","profileImage":""},"comment":"comment from t12","text":"comment from t12","contentType":"text/plain","published":"Sun Dec 05 2021 21:25:23 GMT-0700 (Mountain Standard Time)","id":"http://localhost:8000/service/post/025bdeef-e3c0-4195-a1dc-0ced6571992e/comments/2b1d31ea-2305-4105-9141-01ce711b803b","url":"https://cmput404f21t17.herokuapp.com/author/0fbc1b88-2d7c-44a4-83b9-ef5b1198f692","display name":"comment from t12"
}